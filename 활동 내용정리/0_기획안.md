# 9/19일 기준 (2일차 수행작업)
필수 영양소 10가지 체크: 
CORE_NUTRIENTS = [
    "Vitamin C", "Vitamin D", "Vitamin B6", "Vitamin B12", "Folate",
    "Magnesium", "Zinc", "Calcium", "Iron", "Omega-3(DHA)"
]
 - 최종 잘 돌아가는지 확인할 것: 
 상품에 포함된 영양소 함량기준을 파악할 수 있는지, 그것을 RDA와 사용자 입력값에 맞춰서 좋은 상품을 추천해 줄 수 있는지(중복성분체크 예상 시나리오:"나는 지금 비타민c500mg을 섭취 중이야. 그리고 피로한 증상에 좋은 영양제를 찾고 있어. 상품 추천해줘 라고 입력하면) (1) 피로 증상에 맞는 영양제를 매핑한다(goal_based_node) 
 (2) RDA 를 확인하여 부족한 영양소를 충족할 수 있는 영양제를 "실제 상품에 포함된 영양소 함량"를 확인하고 추천한다. 1회분에 해당 영양소를 몇 mg 포함하는지 

* 좋은 조합 나쁜 조합 출처 (https://ods.od.nih.gov/factsheets/VitaminB12-Consumer/) >> 권장량도 나와 있음. 
🔸 NIH Office of Dietary Supplements
영양소 간 상호작용에 대한 공식 가이드 제공
🔸 식품의약품안전처(대한민국)
건강기능식품 영양소 상호작용 표 제시
🔸 논문: “Nutrient interactions: effects on absorption and bioavailability”
영양소 간 흡수 경쟁과 시너지 메커니즘 분석
🔸 전문 서적: “Clinical Nutrition”
임상 영양학 교재 기준 조합

## 1. 에이전트가 수행해야 할 역할 
 
	🔍 A. 사용자 정보 기반 추천
	•	성별, 연령대, 건강 증상(예: 피로, 수면장애) 입력
	•	사용 중인 영양제 입력 (중복 성분 체크, 과잉 복용 방지)
	•	건강 목적에 맞는 필수 영양소 우선 추천

    ⚠ B. 섭취 조합 검토
	•	나쁜 조합: 칼슘+철분, 마그네슘+아연(고용량), 철분+커피
	•	좋은 조합: 비타민 C+철분, 오메가-3+비타민 D 등

        🧠 C. 섭취 가이드라인 제공
	•	섭취 시간대별 추천 (아침/점심/저녁)
	•	성분 기준 권장 섭취량 vs. 사용자 실제 섭취량 비교

    💬 D. 리뷰 기반 품질 판단
	•	리뷰 평점/갯수 기반 품질 판단 (ex. 평점 4.8 이상, 리뷰 500+ 우선)
	•	특정 영양소에 대해 효과가 좋다는 리뷰 요약도 가능

## 2. SQL DB 스키마 설계 (PostgreSQL)
좋아 유진, 지금까지 기획안과 데이터 파일(supplement_rag_data_merged_with_reviews.json)을 바탕으로 정리해볼게.

⸻

✅ 1. 에이전트가 수행할 수 있는 주요 역할 (기획안 기반)

기획안에서 확인된 “사용자 맞춤형 영양제 추천 에이전트”의 기능은 다음과 같아:

🔍 A. 사용자 정보 기반 추천
	•	성별, 연령대, 건강 증상(예: 피로, 수면장애) 입력
	•	사용 중인 영양제 입력 (중복 성분 체크, 과잉 복용 방지)
	•	건강 목적에 맞는 필수 영양소 우선 추천

⚠ B. 섭취 조합 검토
	•	나쁜 조합: 칼슘+철분, 마그네슘+아연(고용량), 철분+커피
	•	좋은 조합: 비타민 C+철분, 오메가-3+비타민 D 등

🧠 C. 섭취 가이드라인 제공
	•	섭취 시간대별 추천 (아침/점심/저녁)
	•	성분 기준 권장 섭취량 vs. 사용자 실제 섭취량 비교

💬 D. 리뷰 기반 품질 판단
	•	리뷰 평점/갯수 기반 품질 판단 (ex. 평점 4.8 이상, 리뷰 500+ 우선)
	•	특정 영양소에 대해 효과가 좋다는 리뷰 요약도 가능

⸻

✅ 2. DB 설계 및 구축을 위한 단계 정리

🔨 Step 1. 기초 스키마(DDL) 설계

PostgreSQL로 구축할 테니까, 우선 **DDL 스니펫(스키마 정의 SQL)**을 작성해야 해.
이건 .sql 파일로 저장해서 psql, pgAdmin, 또는 Python에서 실행할 수 있어.

예시 저장 위치:
	•	로컬: ./schema/init_tables.sql
	•	VSCode 프로젝트 폴더 내 db/ 혹은 sql/ 디렉토리 추천

⸻

✅ 3. 추천 DB 테이블 설계안 (DDL 스니펫 포함)

(1) users – 사용자 정보

CREATE TABLE users (
    user_id SERIAL PRIMARY KEY,
    age_group VARCHAR(50),
    gender VARCHAR(10),
    health_issues TEXT[],  -- ["피로", "면역력저하"]
    owned_supplements TEXT[]  -- 사용 중인 영양제 id 리스트
);

(2) nutrients – 필수 영양소 정보

CREATE TABLE nutrients (
    nutrient_id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    daily_rda_male NUMERIC,
    daily_rda_female NUMERIC,
    upper_limit NUMERIC,
    benefits TEXT,
    caution_with TEXT[]  -- ["칼슘", "아연"]
);

(3) products – 영양제 제품 정보

CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    title TEXT,
    brand TEXT,
    description TEXT,
    avg_rating NUMERIC,
    reviews_count INTEGER,
    categories TEXT[]
);

(4) product_nutrients – 제품 내 영양소 성분

CREATE TABLE product_nutrients (
    id SERIAL PRIMARY KEY,
    product_id INTEGER REFERENCES products(product_id),
    nutrient_name TEXT,
    amount NUMERIC,
    unit VARCHAR(20)
);

(5) reviews – 리뷰 요약 or 원문 (필요시)

CREATE TABLE reviews (
    review_id SERIAL PRIMARY KEY,
    product_id INTEGER REFERENCES products(product_id),
    rating NUMERIC,
    review_text TEXT
);

⸻

✅ 4. 전체 구축 작업 순서

1	DDL 파일 작성 및 저장
2	PostgreSQL DB 생성	CREATE DATABASE supplement_ai;
3	테이블 생성	psql 또는 pgAdmin에서 DDL 실행
4	JSON → 테이블 데이터 이관	supplement_rag_data_merged_with_reviews.json 데이터를 파싱하여 products, product_nutrients, reviews에 입력
5	필수 영양소 정보 입력	nutrients 테이블에 PDF 기반 정보 수동 입력 (또는 자동화)
6	테스트용 사용자 정보 입력	users 테이블에 샘플 데이터 입력
7	추천 알고리즘 설계 시작	나이대, 증상별 우선순위 매핑 로직 추가
8	추천 결과 → 챗봇 응답 포맷 설계	LangGraph or LLM과 연결 (추후 진행)





## 실행 체크리스트 
    1.	DB 생성(PostgreSQL) → 위 DDL 실행.
	2.	JSON 스캔 → 성분 사전 시드(동의어 정리).
	3.	RDA 표 적재(연령/성별/단위 일치).
	4.	제품 마스터 적재 → 제품–성분 M:N 적재(정량/단위/ %DV).
	5.	리뷰/집계 적재(랭킹/설명 보강).
	6.	증상–성분 가중치 시드 후 기본 추천 쿼리 테스트.
	7.	품질 점검/인덱스/뷰로 성능·정확도 튜닝.
	8.	LangGraph 연결: DB 쿼리 결과(수치·근거) ↔ RAG로 추천 이유 문장화

